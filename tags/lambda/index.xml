<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>lambda on circuitshelter</title><link>https://circuitshelter.com/tags/lambda/</link><description>Recent content in lambda on circuitshelter</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 19 Jul 2021 14:30:00 +0000</lastBuildDate><atom:link href="https://circuitshelter.com/tags/lambda/index.xml" rel="self" type="application/rss+xml"/><item><title>Checking host availability with Python and AWS Lambda</title><link>https://circuitshelter.com/posts/aws-lambda-python-check-host/</link><pubDate>Mon, 19 Jul 2021 14:30:00 +0000</pubDate><guid>https://circuitshelter.com/posts/aws-lambda-python-check-host/</guid><description>AWS Lambda is great for quick and straightforward tasks without any unnecessary functions complications. But Sometimes you need to optimize your approach even for such simple task as checking host availability to make it as fast and minimal as possible.
For this task we are going to use Low-level networking interface from Python 3 to try establish connection directly to remote socket without help of any additional protocols like ICMP.</description><content>&lt;p>&lt;a href="https://aws.amazon.com/lambda/">AWS Lambda&lt;/a> is great for quick and straightforward tasks without any unnecessary functions complications.
But Sometimes you need to optimize your approach even for such simple task as checking host availability to make it as fast and minimal as possible.&lt;/p>
&lt;p>For this task we are going to use &lt;a href="https://docs.python.org/3/library/socket.html">Low-level networking interface from Python 3&lt;/a> to try establish connection directly to remote socket without help of any additional protocols like &lt;a href="https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol">ICMP&lt;/a>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> socket &lt;span style="color:#f92672">import&lt;/span> socket, AF_INET, SOCK_STREAM
addresses &lt;span style="color:#f92672">=&lt;/span> [
{&lt;span style="color:#e6db74">&amp;#39;example.com&amp;#39;&lt;/span>: &lt;span style="color:#ae81ff">80&lt;/span>},
{&lt;span style="color:#e6db74">&amp;#39;example.com&amp;#39;&lt;/span>: &lt;span style="color:#ae81ff">443&lt;/span>},
{&lt;span style="color:#e6db74">&amp;#39;host-1234567890-notexist.example.com&amp;#39;&lt;/span>: &lt;span style="color:#ae81ff">1234&lt;/span>}]
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">echo&lt;/span>(addresses: list):
results &lt;span style="color:#f92672">=&lt;/span> {}
&lt;span style="color:#66d9ef">for&lt;/span> address &lt;span style="color:#f92672">in&lt;/span> addresses:
&lt;span style="color:#66d9ef">for&lt;/span> host, port &lt;span style="color:#f92672">in&lt;/span> address&lt;span style="color:#f92672">.&lt;/span>items():
&lt;span style="color:#66d9ef">try&lt;/span>:
s &lt;span style="color:#f92672">=&lt;/span> socket(AF_INET, SOCK_STREAM)
s&lt;span style="color:#f92672">.&lt;/span>connect((str(host), int(port)))
&lt;span style="color:#66d9ef">except&lt;/span> &lt;span style="color:#a6e22e">OSError&lt;/span>:
results[&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>host&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">:&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>port&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">False&lt;/span>
&lt;span style="color:#66d9ef">else&lt;/span>:
s&lt;span style="color:#f92672">.&lt;/span>close
results[&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>host&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">:&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>port&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">True&lt;/span>
&lt;span style="color:#66d9ef">return&lt;/span> results
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">lambda_handler&lt;/span>(event, context):
&lt;span style="color:#66d9ef">return&lt;/span> echo(addresses)
&lt;/code>&lt;/pre>&lt;/div></content></item></channel></rss>